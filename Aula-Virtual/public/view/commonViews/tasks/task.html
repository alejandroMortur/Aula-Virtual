<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="/Aula-Virtual/public/assets/icons/page-icon/favicon.png" type="image/x-icon">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <meta http-equiv="Last-Modified" content="0">
    <title>Tarea</title>
    <script src="/Aula-Virtual/public/assets/class/user.js"></script>
    <script src="/Aula-Virtual/public/assets/class/coursesTask.js"></script>
    <script src="/Aula-Virtual/public/assets/class/document.js"></script>
    <script src="/Aula-Virtual/public/assets/js/menu.js"></script>
    <script src="/Aula-Virtual/public/assets/js/loader.js"></script>
    <script src="/Aula-Virtual/public/assets/js/footer.js"></script>
    <script src="task.js"></script>
    <link rel="stylesheet" type="text/css" href="/Aula-Virtual/public/assets/css/menu.css" />
    <link rel="stylesheet" type="text/css" href="task.css" />
    <link rel="stylesheet" type="text/css" href="/Aula-Virtual/public/assets/css/footer.css" />
</head>
<body class="grid-container">

    <script> 
        async function init() {

            let currentUser = new User(JSON.parse(sessionStorage.getItem("user")));
            let newTask = JSON.parse(sessionStorage.getItem("newTask"));

            let loader = new Loader();
            let loc = "task";
            loadMenu(currentUser,loc);

            let statusSolution = "";
            let currentTask = "";
            let document = "";
            let statusHeader = newTask;

            if(newTask == "notNew"){    

                currentTask = new CoursesTask(JSON.parse(sessionStorage.getItem("task")));
            
                const documentDataArray = await loader.loadDocumentCoursesTasks(currentTask.getTaskId()); 
                document = documentDataArray.map(documentData => new Document(documentData));

                statusSolution = document[0].getStatus();
                statusHeader = document[1].getStatus();

            }

            if(statusHeader == 'done' && statusSolution == 'done'){
                createTaskHeader(currentTask,document,statusHeader);
                createTaskBody(document,statusSolution);
            }else
                createTaskHeader(currentTask,document,statusHeader);

            loadFooter();

        }

        window.onload = init;
    </script>

    <header class="header" id="header"> </header>
    <aside class="sidebar">
        <div id="sideBar">
        </div>
    </aside>
    <article class="main">
        <div id="taskHeader">
        </div>
        <div id="taskBody">
        </div>
    </article>
    <footer class="footer" id="footer"></footer>

</body>
</html>